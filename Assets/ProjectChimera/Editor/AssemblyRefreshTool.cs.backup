using UnityEngine;
using UnityEditor;
using UnityEditor.Compilation;
using ProjectChimera.Core.Logging;

namespace ProjectChimera.Editor
{
    /// <summary>
    /// Tool to refresh assembly definitions and force Unity to recompile.
    /// Use this when assembly references are changed or when experiencing compilation issues.
    /// </summary>
    public static class AssemblyRefreshTool
    {
        [MenuItem("Tools/Project Chimera/Refresh Assembly Definitions")]
        public static void RefreshAssemblyDefinitions()
        {
            UnityEngine.Debug.Log("Operation completed");
            
            // Force Unity to refresh assets
            AssetDatabase.Refresh();
            
            // Request script compilation
            CompilationPipeline.RequestScriptCompilation();
            
            UnityEngine.Debug.Log("Operation completed");
        }
        
        [MenuItem("Tools/Project Chimera/Force Recompile")]
        public static void ForceRecompile()
        {
            UnityEngine.Debug.Log("Operation completed");
            
            // Refresh assets
            AssetDatabase.Refresh();
            
            // Force garbage collection
            System.GC.Collect();
            
            // Request script compilation
            CompilationPipeline.RequestScriptCompilation();
            
            UnityEngine.Debug.Log("Operation completed");
        }
    }
} 